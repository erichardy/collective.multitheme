<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.multitheme">

<body>

<div metal:fill-slot="content-core">
<metal:block define-macro="content-core">

<style>
.accordeon-title {
  color: #555555;
  cursor: -webkit-grab;
  cursor: pointer;
  padding: 5px 3px 5px 10px;
  border: 1px solid #AAAAAA;
  background-color: #DDDDDD;
  border-radius: 3px;
  /* width: 728px; */
}
.go-to-page {
  text-shadow: 3px 2px #DDDDDD;
  font-size: 80%;
  float: right;
}

.tooltip-inner {
  color: #030303 !important;
  font-family: "Roboto";
  background-color: #FAFAFA !important;
  /* max-width: 500px !important; */
}

.xtooltip {
    position: relative;
    /* display: inline-block; */
    /* border-bottom: 1px dotted black; */
}

.xtooltip .xtooltiptext {
    visibility: hidden;
    min-width: 400px;
    max-width: 700px;
    background-color: #555;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 5%;
    margin-left: -60px;
    opacity: 0;
    transition: opacity 0.3s;
}

.xtooltip .xtooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 5%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #555 transparent transparent transparent;
}

.xtooltip:hover .xtooltiptext {
    visibility: visible;
    opacity: 1;
}
</style>


<div 
        tal:define="results view/getDocuments;
                    token context/@@authenticator/token;
                    desc python:context.description;
                    contextId context/getId;"
        class="folder-contents-accordion">

  <h3>
        ${context/title}
  </h3>
   
  <tal:conditon tal:condition="results">
  
    	<span tal:repeat="item results">
    	  <span tal:define="itemClass string:${item/id}-${repeat/item/number};
    	                    desc python:item.description if item.description else ' ';
    	                    item_url item/absolute_url"
    	                    >
		  	<p class="xtooltip accordeon-title"
		  	   tal:attributes="id string:${itemClass};">${item/title}
		  	  <span class="xtooltiptext"
		  	        tal:condition="python:len(desc) > 2"
		  	        tal:content="string:${desc}">
		  	</p>
		  	  <span tal:attributes="class string:${itemClass} accordeon-content">
		  	    <span tal:condition="python:item.text"
		  	          tal:content="structure string:${item/text/output}">
		  	      text
		  	    </span>
			     <a tal:condition="python:view.canEdit(item)"
			         class="go-to-page" href=""
		  	         tal:attributes="target string:_blank;
		  	                         href string:${item_url}?_authenticator=${token}"
		  	         i18n:translate=""
		  	      >Go to page</a>
			  
			</span>  
		  </span>
	    </span>

  <script>
    require([
      'jquery',
      ], function(Base) {
    	// template = '<span class="tooltip" role="tooltip"><span class="arrow"></span><span class="tooltip-inner"></span></span>'
    	$('[data-toggl="mytooltip"]').tooltip({html: true, placement: "top"});
    	
    	var accordion_head = $('.accordeon-title');
		var accordion_body = $('.accordeon-content');

		$(accordion_body).each(function(){$(this).hide()});

		// Lorsqu'on clique sur un titre
		accordion_head.on('click', function(event) {
			event.preventDefault();
			title = $(this).attr('id');
			toShow = 'span.' + title;
			if ($(toShow).css("display") != "none") {
				$(toShow).hide(500, "swing");
			} else {
				$(accordion_body).each(function(){$(this).hide(500, "swing")});
			    $(toShow).show(500, "swing");
			}
		});
      });
  </script>
  </tal:conditon>
</div>

</metal:block>
</div>
</body>
</html>